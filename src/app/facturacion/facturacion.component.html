<app-navbar></app-navbar>
<div class="container color text-center mt-5">
  <p-fieldset legend="FACTURACION">
    <div class="row m-4">
      <mat-card>
        <div class="container text-center">
          <div class="row">
            <div class="col">
              <label class="form-label">N Factura</label>
              <input type="number" class="form-control" [(ngModel)]="factura.fac_num" id="fac_num" name="fac_num" />
            </div>
            <div class="col">
              <label class="form-label">FECHA FACTURA</label>
              <input type="datetime" class="form-control" [(ngModel)]="factura.fac_fec" id="fac_fec" name="fac_fec" />
            </div>
            <div class="col">
              <label class="form-label">TIPO DE PAGO</label>
              <input type="text" class="form-control" [(ngModel)]="factura.fac_tpag" id="fac_tpag" maxlength="1"
                name="fac_tpag" />
            </div>
            <div class="col">
              <label class="form-label">SERIE</label>
              <input type="text" class="form-control" [(ngModel)]="factura.fac_ser " id="" name=""
                aria-describedby="" />
            </div>
            <div class="col">
              <label class="form-label">SUCURSAL</label>
              <input type="text" class="form-control" [(ngModel)]="factura.suc_cod" id="" maxlength="3" name=""
                aria-describedby="" />
            </div>
          </div>
        </div>
      </mat-card>
    </div>
    <div class="row m-2">
      <mat-card>
        <mat-card-title>
          CLIENTE
        </mat-card-title>
        <div class="container text-center">
          <div class="row" #divCliente id="divCliente">
            <div class="col">
              <label class="form-label">CODIGO</label>

              <input type="text" class="form-control" #idcli_cod id="idcli_cod"
                [(ngModel)]="this.gvariablesBus.g_clicod" (focusout)="foucuscliente(idcli_cod)"
                value="{{ this.gvariablesBus.g_DatosCli.cli_cod }}"
                (keydown)="precionarTecla($event , divCliente.id,idcli_cod.id)" placeholder="" />
            </div>
            <div class="alert alert-danger" role="alert" *ngIf="false">
              A simple danger alertâ€”check it out!
            </div>
            <div class="col" id="div_cli_nom">
              <label class="form-label">NOMBRE</label>
              <input type="text" class="form-control" #idcli_nom
                (keydown)="precionarTecla($event , divCliente.id,idcli_nom.id)" id="idcli_nom"
                [(ngModel)]="this.gvariablesBus.g_clinom" value="{{ this.gvariablesBus.g_DatosCli.cli_nom }}"
                (focusout)="foucuscliente(idcli_nom)" autocomplete="false" />
            </div>

            <div class="col">
              <label class="form-label">ESTADO</label>
              <input type="text" class="form-control" id="idcli_est" value="{{this.gvariablesBus.g_DatosCli.cli_est}}"
                disabled />
            </div>
            <div class="col">
              <label class="form-label">CORREO</label>
              <input type="text" class="form-control" id="idcli_ccl_cod"
                value="{{this.gvariablesBus.g_DatosCli.cli_email}}" disabled />
            </div>
          </div>
        </div>
      </mat-card>
    </div>
    <div class="row m-4">
      <mat-card>
        <mat-card-title>
          ARTICULO
        </mat-card-title>
        <div class="container text-center">
          <div class="row" #divArticulo id="divArticulo">
            <div class="col" name="div_art_cod" id="div_art_cod">
              <label class="form-label">CODIGO </label>
              <input type="text" class="form-control" #idart_cod id="idart_cod" [(ngModel)]="this.fart_cod"
                (keydown)="precionarTecla($event , divArticulo.id, idart_cod.id)"
                value="{{this.gvariablesBus.g_DatosArt.art_cod}}" (focusout)="foucusArticulo(idart_cod)" />
            </div>
            <div class="col" id="div_art_nom">
              <label class="form-label">NOMBRE</label>
              <input type="text" class="form-control" #idart_nom
                (keydown)="precionarTecla($event , divArticulo.id,idart_nom.id)" [(ngModel)]="this.fart_nom"
                id="idart_cod" id="idart_nom" (focusout)="foucusArticulo(idart_nom)"
                value="{{this.gvariablesBus.g_DatosArt.art_nom}}" />
            </div>
            <div class="col">
              <label class="form-label">CANTIDAD </label>
              <input type="number" class="form-control" [(ngModel)]="fart_cant" #idfcant id="idfcant" />
            </div>
            <div class="col">
              <label class="form-label">Precio</label>
              <input type="number" class="form-control" [(ngModel)]="this.gvariablesBus.g_DatosArt.art_prec"
                id="idart_prec" name="" disabled />
            </div>
            <div class="col">
              <label class="form-label">IVA</label>
              <input type="number" class="form-control"  value="{{this.gvariablesBus.g_DatosArt.art_pimpto}}" [(ngModel)]="this.fIVA "
                  disabled=""/>
            </div>
            <div class="col mt-4">
              <button type="button" class="btn btn-primary" (click)="agregarArt()" data-bs-dismiss="modal" [disabled]="this.F_Bagregar">
                AGREGAR
              </button>
            </div>
          </div>
        </div>
      </mat-card>
    </div>
    <div class="row m-4 hscroll" *ngIf="this.vertable">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">N-FACTURA</th>
            <th scope="col">CODIGO ART</th>
            <th scope="col">NOMBRE ART</th>
            <th scope="col">CANTIDAD</th>
            <th scope="col">PRECIO</th>
            <th scope="col">IVA</th>
            <th scope="col">DESCUENTO</th>
            <th scope="col">SUBTOTAL</th>
            <th scope="col">eliminar</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of this.factura.Detalles">
            <th>{{ item.fac_num }}</th>
            <th>{{ item.art_cod }}</th>
            <th>{{ item.art_nom }}</th>
            <th>
              <input type="number" class="form-control" #idTcant id="idTcant" [(ngModel)]="item.fdt_cant"
                placeholder="{{ item.fdt_cant }}" (focusout)="fousTable(item ,idTcant.value)" />
            </th>
            <th>{{ item.fdt_prec }}</th>
            <th>{{ item.fdt_iva }}</th>
            <th>{{ item.fdt_desc }}</th>
            <th>{{ item.fdt_sub }}</th>
            <th>
              <button mat-raised-button color="warn" (click)="eliminar(item)">
                -
              </button>
            </th>
          </tr>
        </tbody>
      </table>

    </div>
    <div class="row">
      <div class="col-2">
        <h3>Total</h3>
      </div>

      <div class="col-10 " ALIGN=left>
        <label>
          SUB0:    {{this.gvariablesBus.gsubtotal0}}
        </label>
        <br>
        <label>
          SUB1:   {{this.gvariablesBus.gsubtotal1}}
        </label>
        <br>
        <label>
          DESC:   {{this.gvariablesBus.g_dec}}
        </label>
        <br>
        <label>
          IVA:    {{this.gvariablesBus.g_iva}}
        </label>
        <br>
        <label>
          TOTAL:    {{this.gvariablesBus.g_total}}
        </label>
      </div>
    </div>
    <div class="row m-4 text-center ">
    </div>
    <button mat-raised-button color="accent" (click)="Guardar()">
      Nueva factura
    </button>

  </p-fieldset>



</div>
